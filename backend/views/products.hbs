{{> header }}
<main>
  <h1 class="text-center">Productos</h1>
    {{#if product}}
    <form action="/admin/productos/{{product._id}}?_method=PUT" class="container form-product" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="_method" value="PUT">
    {{else}}
    <form action="/admin/productos" class="container form-product" method="POST" enctype="multipart/form-data">
    {{/if}}
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="titulo">Título</label>
          <input type="text" class="form-control" value="{{product.title}}" name="title" placeholder="Titulo o nombre del producto">
        </div>
        <div class="form-group col-md-6">
          <label for="descripcion">Descripción</label>
          <input type="text" class="form-control" value="{{product.description}}" name="description" placeholder="Descripción del producto">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="detalles">Detalles técnicos</label>
          <input type="text" class="form-control" value="{{product.features}}" name="features" placeholder="Detalles técnicos">
        </div>
        <div class="form-group col-md-6">
          <label for="precio">Precio</label>
          <input type="number" step="0.05" class="form-control" value="{{product.price}}" name="price"
              placeholder="Precio por unidad">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="categoria">Categoría</label>
          <select class="form-control" name="category" value="{{product.category}}">
            <option>{{product.category}}</option>
            <option>Accesorios</option>
            <option>Camisetas</option>
            <option>Games</option>
            <option>Tazas</option>
          </select>
        </div>
        <div class="form-group col-md-6">
          <label for="unidades">Unidades disponibles</label>
          <input type="number" class="form-control" name="quantity" value="{{product.quantity}}" placeholder="Cantidad de unidades disponibles">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="imagenes">Archivos de imagenes</label>
          <input type="file" class="form-control" id="imagesNew" name="images" multiple>
        </div>
        {{#if product}}
        <input type="text" class="form-control hidden" name="id" value="{{product._id}}">
        <input type="text" class="form-control hidden" id="images" name="images" value="{{product.images}}">
        {{#if product.image1}}
        <div class="form-group col-md-1">
          <img src="/images/{{product.image1}}" id="img1" data-id="{{product.image1}}" alt="Imagen producto">
        </div>
        {{/if}}
        {{#if product.image2}}
        <div class="form-group col-md-1">
          <img src="/images/{{product.image2}}" id="img2" data-id="{{product.image2}}" alt="Imagen producto">
        </div>
        {{/if}}
        <div class="form-check col-md-4">
          <input class="form-check-input" type="checkbox" name="featured" value="true" id="check1">
          <label class="form-check-label" for="check1">Producto destacado</label>
        </div>
        <div class="form-group col-md-12">
          <input type="submit" class="form-control btn" id="update" data-id="{{product._id}}" value="Actualizar">
        </div>
        {{else}}
        <div class="form-check col-md-6">
          <input class="form-check-input" type="checkbox" name="featured" value="true" id="check1">
          <label class="form-check-label" for="check1">Producto destacado</label>
        </div>
        <div class="form-group col-md-6">
          <input type="submit" class="form-control" value="Guardar">
        </div>
        {{/if}}
      </div>
      {{#if message}}
      <div class="form-row">
        <div class="col-md-12 alert alert-success text-center" role="alert">{{ message }}</div>
      </div>
      {{/if}}
  </form>

  {{#if products}}
  <section class="container">
    <input type="text" class="form-control row search-console" id="search" placeholder="Buscar">
  </section>

  <section class="product-list">
    {{#each products}}
    <div class="card">
      <img class="card-img-top" src="/images/{{this.image}}" alt="Card image cap">
      <div class="card-body">
        <h5 class="card-title">{{this.title}}</h5>
        <p class="card-text">{{this.description}}</p>
        <a class="delete btn btn-danger" data-id="{{this.id}}"><i data-id="{{this.id}}" class="fas fa-trash-alt"></i></a>
        <a href="/admin/productos/{{this.id}}" class="btn btn-primary"><i class="fas fa-pen"></i></a>
      </div>
    </div>
    {{/each}}
  </section>
  {{/if}}
</main>